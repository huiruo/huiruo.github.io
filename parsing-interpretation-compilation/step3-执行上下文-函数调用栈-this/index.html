<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">step3-执行上下文-函数调用栈-this | Programming tech</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://huiruo.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://huiruo.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://huiruo.github.io/parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="step3-执行上下文-函数调用栈-this | Programming tech"><meta data-rh="true" name="description" content="执行上下文定义"><meta data-rh="true" property="og:description" content="执行上下文定义"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://huiruo.github.io/parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this"><link data-rh="true" rel="alternate" href="https://huiruo.github.io/parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this" hreflang="en"><link data-rh="true" rel="alternate" href="https://huiruo.github.io/parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0527b3af.css">
<link rel="preload" href="/assets/js/runtime~main.7d4c0755.js" as="script">
<link rel="preload" href="/assets/js/main.ce1577d7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">programming-tech</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Main</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/huiruo/programming-tech-website/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Readme</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/React概览">React概览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Vue概览">Vue概览</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/React/jsx-ast-render阶段">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Vue/vue3/库-状态管理">Vue</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/JavaScript/继承/es6-extends">JavaScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/html-css/requestAnimationFrame/requestAnimationFrame-是宏任务吗">html-css</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/http-browserCache/浏览器请求-渲染的流程">http-browserCache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/parsing-interpretation-compilation/模块化/esm">parsing-interpretation-compilation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/parsing-interpretation-compilation/模块化/esm">模块化</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/parsing-interpretation-compilation/Parser解析得到AST-Ignition解释得到字节码">Parser解析得到AST-Ignition解释得到字节码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/parsing-interpretation-compilation/step1-预解析-变量提升">step1-预解析-变量提升</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/parsing-interpretation-compilation/step2-作用域-块级作用域原理">step2-作用域-块级作用域原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this">step3-执行上下文-函数调用栈-this</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/parsing-interpretation-compilation/闭包-内存生命周期">闭包-内存生命周期</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/parsing-interpretation-compilation/旧-变量对象">旧-变量对象</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/promise-eventLoop-security/promise/promise基础">promise-eventLoop-security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/build-webpack/dynamic-import/动态加载">webpack</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/build-AST-Babel/AST">AST-Babel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/build-monorepo-turbopack/monorepo">monorepo-turbopack</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SSR-Nodejs/react-ssr渲染">SSR-Nodejs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/web-optimization/总结">web optimization</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/C++-V8/v8/v8基础">C++-V8</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/backend/nextjs/">backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docker/Docker基础">docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/design-patterns/">design patterns</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/regular-string/正则-基础">regular-string</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">parsing-interpretation-compilation</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">step3-执行上下文-函数调用栈-this</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>step3-执行上下文-函数调用栈-this</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="执行上下文定义">执行上下文定义<a href="#执行上下文定义" class="hash-link" aria-label="Direct link to 执行上下文定义" title="Direct link to 执行上下文定义">​</a></h2><p>理解闭包就不得不去理解作用域和执行上下文，理解this得理解词法作用域规则。</p><p>闭包、this可以把它们放在一个完整的知识链路里来理解，那就是JS 的执行上下文。</p><blockquote><p><code>理解执行上下文和执行栈对于理解其他 JavaScript 概念（如变量声明提升，作用域和闭包）至关重要。</code></p></blockquote><p>执行上下文 包含了变量、函数声明，参数（arguments），作用域链，this等信息,一个执行上下文会包含以下内容：</p><ul><li>变量环境:var，function 变量存放在变量环境</li><li>词法环境:包含了使用 let、const 等变量的内容。</li><li>this 指针,this指的是执行上下文所属的作用域。一旦作用域链被创建，JS引擎就会初始化this关键字的值。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="闭包的本质"><code>闭包的本质:</code><a href="#闭包的本质" class="hash-link" aria-label="Direct link to 闭包的本质" title="Direct link to 闭包的本质">​</a></h3><p>作用域大部分时候是静态作用域,又叫词法作用域,这是因为作用域的嵌套关系可以在语法分析时确定;</p><p>闭包保持着对父函数得作用域引用，这在语法分析已经确定，父级函数的执行上下文在运行时赋值，所以闭包return的值就是执行上下文赋值的值，也就是父级函数执行之后不会销毁引用的作用域。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="三种上下文-1全局执行上下文">三种上下文-1.全局执行上下文<a href="#三种上下文-1全局执行上下文" class="hash-link" aria-label="Direct link to 三种上下文-1.全局执行上下文" title="Direct link to 三种上下文-1.全局执行上下文">​</a></h3><p>只有一个，浏览器中的全局对象就是 window 对象，this 指向这个全局对象。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="三种上下文-2eval-函数执行上下文">三种上下文-2.Eval 函数执行上下文<a href="#三种上下文-2eval-函数执行上下文" class="hash-link" aria-label="Direct link to 三种上下文-2.Eval 函数执行上下文" title="Direct link to 三种上下文-2.Eval 函数执行上下文">​</a></h3><p>指的是运行在 eval 函数中的代码，很少用而且不建议使用。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三种上下文-3函数执行上下文-重点">三种上下文-3.函数执行上下文-重点<a href="#三种上下文-3函数执行上下文-重点" class="hash-link" aria-label="Direct link to 三种上下文-3.函数执行上下文-重点" title="Direct link to 三种上下文-3.函数执行上下文-重点">​</a></h2><p>存在无数个，只有在函数被调用的时候才会被创建，每次调用函数都会创建一个新的执行上下文。函数作用域是在函数声明的时候就已经确定了，而函数执行上下文是在函数调用时创建的。</p><p>在 JavaScript 中，执行上下文包括两个主要阶段：创建阶段和执行阶段。</p><ol><li>创建阶段：在创建阶段，JavaScript 引擎会做以下事情：<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 创建变量对象（Variable Object），用于存储变量、函数声明和函数参数。</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 建立作用域链（Scope Chain），这是一个指向父级执行上下文的引用链，用于在作用域中查找标识符。</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 确定 this 的值，即确定函数在执行时的上下文对象。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>在创建阶段，变量和函数声明会被提升（即在作用域内可见但未赋值），这就是为什么在执行上下文中可以访问未赋值的变量。</p></blockquote></li><li>执行阶段：在执行阶段，JavaScript 引擎会执行实际的代码，为变量分配值，并执行函数。在这个阶段，执行上下文的状态会根据代码的执行而改变。例如，变量的值会在执行时被赋值，函数会被调用，this 的值可能会随着函数的执行环境而改变。</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="和全局执行上下文之间的不同主要体现在以下方面上">和全局执行上下文之间的不同主要体现在以下方面上<a href="#和全局执行上下文之间的不同主要体现在以下方面上" class="hash-link" aria-label="Direct link to 和全局执行上下文之间的不同主要体现在以下方面上" title="Direct link to 和全局执行上下文之间的不同主要体现在以下方面上">​</a></h3><p>它在机制层面和全局上下文高度一致，只需要关注它与全局上下文之间的不同即可</p><ol><li>创建的时机:全局上下文在进入脚本之初就被创建，而函数上下文则是在函数调用时被创建</li><li>创建的频率:全局上下文仅在代码刚开始被解释的时候创建一次；而函数上下文由脚本里函数调用的多少决定，理论上可以创建无数次</li><li>创建阶段的工作内容不完全相同,函数上下文不会创建全局对象（Window），而是创建参数对象（arguments）；创建出的 this 不再死死指向全局对象，而是取决于该函数是如何被调用的,如果它被一个引用对象调用，那么 this 就指向这个对象；</li></ol><p>对比:
全局执行上下文:</p><ul><li>创建一个全局变量对象存储函数和变量声明。</li><li>创建 <code>this</code> 对象将全局作用域中所有变量和函数作为属性和方法存储。</li><li>不可以访问函数上下文中的代码</li></ul><p>函数执行上下文:</p><ul><li>并不创建全局变量对象。相反，创建arguments对象存储所有传入函数的参数。</li><li>不创建<code>this</code> 对象，但可以访问被定义的环境，通常情况下为 <code>window</code> 对象。</li><li>通过作用域查找，可以访问上下文以及父上下文中的代码（变量和函数）。</li></ul><p>debugger 进入 aFn(),会进入函数上下文的创建阶段，在这个阶段里，函数上下文的内容如下：</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a2 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">aFn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a4 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a5 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">a1</span><span class="token operator">:</span><span class="token plain"> a1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">a2</span><span class="token operator">:</span><span class="token plain"> a2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">a3</span><span class="token operator">:</span><span class="token plain"> val</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;test&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> a1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">aFn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token literal-property property">Phase</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">Creation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">arguments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token literal-property property">length</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">a1</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">a2</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token operator">:</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">window</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/assets/images/函数的执行上下文例子-f9e7a135443555786949639a13697726.png" width="802" height="576" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="执行上下文的三个生命周期">执行上下文的三个生命周期<a href="#执行上下文的三个生命周期" class="hash-link" aria-label="Direct link to 执行上下文的三个生命周期" title="Direct link to 执行上下文的三个生命周期">​</a></h2><blockquote><p>ES5 规范去除了 ES3 中变量对象和活动对象，以词法环境组件(LexicalEnvironment component）和变量环境组件（VariableEnvironment component）替代。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="执行上下文两个阶段创建阶段-执行阶段">执行上下文两个阶段:创建阶段-执行阶段<a href="#执行上下文两个阶段创建阶段-执行阶段" class="hash-link" aria-label="Direct link to 执行上下文两个阶段:创建阶段-执行阶段" title="Direct link to 执行上下文两个阶段:创建阶段-执行阶段">​</a></h3><p>执行上下文是在编译阶段就被确定了的，但是执行的时候会被赋值修改,es5 执行上下文的生命周期也包括三个阶段：</p><ol><li>创建阶段 —— 执行上下文的初始化状态，此时一行代码都还没有执行，只是做了一些准备工作</li><li>执行阶段 —— 逐行执行脚本里的代码</li></ol><p>Phase: Creation 就是创建阶段的全局上下文概览。为啥这时候变量没有值呢？这是因为创建阶段里，JS 引擎不多不少只做这么几件事：</p><ol><li>创建全局对象（Window/Global）</li><li>创建 this ，并让它指向全局对象,也被称为 This Binding</li><li>LexicalEnvironment（词法环境） 组件被创建</li><li>VariableEnvironment（变量环境） 组件被创建</li><li>给变量和函数安排内存空间</li><li>默认给变量赋值为 undefined；将函数声明放入内存,创建作用域链</li></ol><span style="font-weight:bold;color:#337ab7">词法环境的结构如下：</span><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token maybe-class-name">GlobalExecutionContext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// 全局执行上下文</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  LexicalEnvironment</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">// 词法环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    EnvironmentRecord</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 环境记录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      Type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Object&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">// 全局环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// 标识符绑定在这里 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      outer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token keyword null nil" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token operator">&gt;</span><span class="token plain">         </span><span class="token comment" style="color:rgb(98, 114, 164)">// 对外部环境的引用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token maybe-class-name">FunctionExecutionContext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 函数执行上下文</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  LexicalEnvironment</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">// 词法环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    EnvironmentRecord</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// 环境记录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      Type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Declarative&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// 函数环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// 标识符绑定在这里      // 对外部环境的引用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      outer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Global or outer </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> environment reference</span><span class="token operator">&gt;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a2 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">aFn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">a1</span><span class="token operator">:</span><span class="token plain"> a1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">a2</span><span class="token operator">:</span><span class="token plain"> a2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;test&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> a1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>js引擎对于我们是个黑盒，根据全局作用域的分析，创建阶段的执行上下文大概如下,可见发生在<code>预编译阶段</code>:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token literal-property property">Phase</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">Creation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">window</span><span class="token operator">:</span><span class="token plain"> global object</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token operator">:</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">window</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">a1</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(189, 147, 249);font-style:italic">undefined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">a2</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(189, 147, 249);font-style:italic">undefined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">aFn</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">fn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/assets/images/创建阶段的执行上下文-204ec26982a47b90b5bc161babe53990.png" width="732" height="459" class="img_ev3q"></p><p>继续往下,执行阶段的全局上下文,看截图，当程序走到console,两个变量都已经赋值,因为 JS 引擎已经在一行一行执行代码、执行赋值操作了
<img loading="lazy" src="/assets/images/执行阶段阶段的执行上下文-ee0d22e01b95f04d12dfe1d095c2875e.png" width="797" height="659" class="img_ev3q"></p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token literal-property property">Phase</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">Execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">window</span><span class="token operator">:</span><span class="token plain"> global object</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token operator">:</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">window</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">a1</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">a2</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token literal-property property">aFn</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">fn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>所以变量提升的本质在于执行上下文的不同阶段，前者发生在预编译，后者发生在执行</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="执行上下文例子">执行上下文例子：<a href="#执行上下文例子" class="hash-link" aria-label="Direct link to 执行上下文例子：" title="Direct link to 执行上下文例子：">​</a></h3><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">fn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> a1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> sum </span><span class="token operator">=</span><span class="token plain"> a </span><span class="token operator">+</span><span class="token plain"> b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;innerFn&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">fn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,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" width="611" height="349" class="img_ev3q"></p><blockquote><p>注意:执行上下文是在编译阶段创建并入栈的,即便代码没有执行。但 let，var 这些变量的声明都已经被提升，只是 let，const，这些词法环境的变量，只提升声明，不提升初始化，因此，V8 限制了访问，这被称为“暂时性死区”。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="调用栈">调用栈<a href="#调用栈" class="hash-link" aria-label="Direct link to 调用栈" title="Direct link to 调用栈">​</a></h2><p>首次运行JS代码时，会创建一个全局执行上下文并Push到当前的执行栈中。每当发生函数调用，引擎都会为该函数创建一个新的函数执行上下文并Push到当前执行栈的栈顶。</p><p>函数执行完毕后，其对应的执行上下文也随之消失了叫做出栈，在 JS 代码的执行过程中，引擎会为我们创建“执行上下文栈”（也叫调用栈),当我们调用一个函数的时候，就会把它的上下文推入调用栈里，执行完毕后出栈，随后再为新的函数进行入栈操作。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> global_let </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> global_val </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">testA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;执行第一个测试函数的逻辑&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> testA1</span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">testB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;再次执行第一个测试函数的逻辑&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">testB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> test1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> test2 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;执行第二个测试函数的逻辑&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">testA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行到testB:
<img loading="lazy" src="/assets/images/函数调用栈例子-114fcd3da1c108641c8225246afa21ec.png" width="898" height="534" class="img_ev3q"></p><p>执行到testB,回到testA中的console:
<img loading="lazy" src="/assets/images/函数调用栈例子-执行完testB-76cb55c1c0859072a0d887a392c5b5b4.png" width="823" height="468" class="img_ev3q"></p><p>执行完回到了全局上下文，总结全过程：
<img loading="lazy" src="/assets/images/函数调用栈例子-执行完js-2471b2fc778cbb5f53bb3a3d2b6edac7.png" width="1793" height="464" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="调用栈例子">调用栈例子<a href="#调用栈例子" class="hash-link" aria-label="Direct link to 调用栈例子" title="Direct link to 调用栈例子">​</a></h3><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> color </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;blue&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">changeColor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> anotherColor </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;red&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">swapColors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> tempColor </span><span class="token operator">=</span><span class="token plain"> anotherColor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        anotherColor </span><span class="token operator">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        color </span><span class="token operator">=</span><span class="token plain"> tempColor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">swapColors</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">changeColor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;color:&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// red</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行过程可以在 devTool 的 call stack 中看到，其中 anonymous 为全局上下文栈；其余为函数上下文栈</p><p>changeColor(),调用栈变成了2个：</p><ul><li>changeColor</li><li>(anonymous)
<img loading="lazy" src="/assets/images/函数调用栈1-1c8dc6bb6b6db9aea56d4c5623af5573.png" width="1006" height="588" class="img_ev3q"></li></ul><p>当执行到swapColors(),调用栈变成了三个：</p><ul><li>swapColors 在栈顶</li><li>changeColor</li><li>(anonymous)
<img loading="lazy" src="/assets/images/函数调用栈2-c3264c46ef713c49cb8c326ffc0b5c83.png" width="717" height="529" class="img_ev3q"></li></ul><p>执行过程：</p><ol><li>首先创建了全局执行上下文，压入执行栈，其中的可执行代码开始执行。</li><li>然后调用 changeColor 函数，JS引擎停止执行全局执行上下文，激活函数 changeColor 创建它自己的执行上下文，且把该函数上下文放入执行上下文栈顶，其中的可执行代码开始执行。</li><li>changeColor 调用了 swapColors 函数，此时暂停了 changeColor 的执行上下文，创建了 swapColors 函数的新执行上下文，且把该函数执行上下文放入执行上下文栈顶。</li><li>当 swapColors 函数执行完后，其执行上下文从栈顶出栈，回到了 changeColor 执行上下文中继续执行。</li><li>changeColor 没有可执行代码，也没有再遇到其他执行上下文了，将其执行上下文从栈顶出栈，回到了 全局执行上下文 中继续执行。</li><li>一旦所有代码执行完毕，JS引擎将从当前栈中移除 全局执行上下文。</li></ol><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">pFn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cFn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">pFn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//输出：1 2 3 4 5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>先有全局环境下的执行上下文，调用pFn后将函数环境pFn的执行上下文压入栈中，由于pFn中执行了cFn函数，所以继续压入cFn函数的执行上下文，执行完毕后依次出栈。全局上下文只有应用程序退出前才会被销毁，比如关闭网页或者退出浏览器
<img loading="lazy" src="/assets/images/图4-执行栈-81a4d7dc30b6db148bbe32e1e3e2effb.png" width="1261" height="471" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/huiruo/programming-tech-website/edit/main/programming-tech/parsing-interpretation-compilation/step3-执行上下文-函数调用栈-this.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/parsing-interpretation-compilation/step2-作用域-块级作用域原理"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">step2-作用域-块级作用域原理</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/parsing-interpretation-compilation/闭包-内存生命周期"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">闭包-内存生命周期</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#执行上下文定义" class="table-of-contents__link toc-highlight">执行上下文定义</a><ul><li><a href="#闭包的本质" class="table-of-contents__link toc-highlight"><code>闭包的本质:</code></a></li><li><a href="#三种上下文-1全局执行上下文" class="table-of-contents__link toc-highlight">三种上下文-1.全局执行上下文</a></li><li><a href="#三种上下文-2eval-函数执行上下文" class="table-of-contents__link toc-highlight">三种上下文-2.Eval 函数执行上下文</a></li></ul></li><li><a href="#三种上下文-3函数执行上下文-重点" class="table-of-contents__link toc-highlight">三种上下文-3.函数执行上下文-重点</a><ul><li><a href="#和全局执行上下文之间的不同主要体现在以下方面上" class="table-of-contents__link toc-highlight">和全局执行上下文之间的不同主要体现在以下方面上</a></li></ul></li><li><a href="#执行上下文的三个生命周期" class="table-of-contents__link toc-highlight">执行上下文的三个生命周期</a><ul><li><a href="#执行上下文两个阶段创建阶段-执行阶段" class="table-of-contents__link toc-highlight">执行上下文两个阶段:创建阶段-执行阶段</a></li><li><a href="#执行上下文例子" class="table-of-contents__link toc-highlight">执行上下文例子：</a></li></ul></li><li><a href="#调用栈" class="table-of-contents__link toc-highlight">调用栈</a><ul><li><a href="#调用栈例子" class="table-of-contents__link toc-highlight">调用栈例子</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.7d4c0755.js"></script>
<script src="/assets/js/main.ce1577d7.js"></script>
</body>
</html>