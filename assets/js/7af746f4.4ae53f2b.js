"use strict";(self.webpackChunkprogramming_technology=self.webpackChunkprogramming_technology||[]).push([[2070],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>f});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),i=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=i(e.components);return r.createElement(s.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=i(t),m=a,f=u["".concat(s,".").concat(m)]||u[m]||d[m]||l;return t?r.createElement(f,o(o({ref:n},p),{},{components:t})):r.createElement(f,o({ref:n},p))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,o=new Array(l);o[0]=m;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[u]="string"==typeof e?e:a,o[1]=c;for(var i=2;i<l;i++)o[i]=t[i];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},62455:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>c,toc:()=>i});var r=t(87462),a=(t(67294),t(3905));const l={title:"\u7f16\u8bd1\u9636\u6bb5-jsx-ast",sidebar_position:1},o=void 0,c={unversionedId:"React/\u7f16\u8bd1\u9636\u6bb5-jsx-ast",id:"React/\u7f16\u8bd1\u9636\u6bb5-jsx-ast",title:"\u7f16\u8bd1\u9636\u6bb5-jsx-ast",description:"\u6784\u5efaAST",source:"@site/programming-tech/React/01-\u7f16\u8bd1\u9636\u6bb5-jsx-ast.md",sourceDirName:"React",slug:"/React/\u7f16\u8bd1\u9636\u6bb5-jsx-ast",permalink:"/React/\u7f16\u8bd1\u9636\u6bb5-jsx-ast",draft:!1,editUrl:"https://github.com/huiruo/programming-tech-website/edit/main/programming-tech/React/01-\u7f16\u8bd1\u9636\u6bb5-jsx-ast.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"\u7f16\u8bd1\u9636\u6bb5-jsx-ast",sidebar_position:1},sidebar:"docs",previous:{title:"Vue\u6982\u89c8",permalink:"/Vue\u6982\u89c8"},next:{title:"\u7f16\u8bd1\u9636\u6bb5-babel\u751f\u6210\u7684code\u51fd\u6570",permalink:"/React/\u7f16\u8bd1\u9636\u6bb5-babel\u751f\u6210\u7684code\u51fd\u6570"}},s={},i=[{value:"\u6784\u5efaAST",id:"\u6784\u5efaast",level:2},{value:"jsx\u8bed\u6cd5\u7684html\u7ed3\u6784\u901a\u8fc7babel\u5c06\u7ed3\u6784\u89e3\u6790\u8f6c\u6362\u4e3aast\u8bed\u6cd5\u6811\u7ed3\u6784",id:"jsx\u8bed\u6cd5\u7684html\u7ed3\u6784\u901a\u8fc7babel\u5c06\u7ed3\u6784\u89e3\u6790\u8f6c\u6362\u4e3aast\u8bed\u6cd5\u6811\u7ed3\u6784",level:3},{value:"\u7b80\u5355\u5b9e\u4f8b1:babel\u5c06jsx\u4ee3\u7801\u8f6c\u6362\u4e3aReact.createElement()\u8c03\u7528",id:"\u7b80\u5355\u5b9e\u4f8b1babel\u5c06jsx\u4ee3\u7801\u8f6c\u6362\u4e3areactcreateelement\u8c03\u7528",level:3},{value:"\u7b80\u5355\u5b9e\u4f8b2:\u76f4\u63a5\u7528\u8f6c\u5316\u540e\u7684\u4ee3\u7801\u53bb\u8c03\u7528React.createElement",id:"\u7b80\u5355\u5b9e\u4f8b2\u76f4\u63a5\u7528\u8f6c\u5316\u540e\u7684\u4ee3\u7801\u53bb\u8c03\u7528reactcreateelement",level:3},{value:"\u7b80\u5355\u5b9e\u4f8b3\uff1a\u4f7f\u7528babel",id:"\u7b80\u5355\u5b9e\u4f8b3\u4f7f\u7528babel",level:3},{value:"\u5b8c\u6574\u6d4b\u8bd5\u4f8b\u5b50",id:"\u5b8c\u6574\u6d4b\u8bd5\u4f8b\u5b50",level:2},{value:"\u6d4b\u8bd5\u4ee3\u7801",id:"\u6d4b\u8bd5\u4ee3\u7801",level:3},{value:"render\u9636\u6bb5-babel\u751f\u6210\u7684AST.json",id:"render\u9636\u6bb5-babel\u751f\u6210\u7684astjson",level:3},{value:"code\u51fd\u6570",id:"code\u51fd\u6570",level:3},{value:"createElement()",id:"createelement",level:3}],p={toc:i},u="wrapper";function d(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u6784\u5efaast"},"\u6784\u5efaAST"),(0,a.kt)("h3",{id:"jsx\u8bed\u6cd5\u7684html\u7ed3\u6784\u901a\u8fc7babel\u5c06\u7ed3\u6784\u89e3\u6790\u8f6c\u6362\u4e3aast\u8bed\u6cd5\u6811\u7ed3\u6784"},"jsx\u8bed\u6cd5\u7684html\u7ed3\u6784\u901a\u8fc7babel\u5c06\u7ed3\u6784\u89e3\u6790\u8f6c\u6362\u4e3aast\u8bed\u6cd5\u6811\u7ed3\u6784"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"react 18\u4e2d\uff1a\u4f7f\u7528 babel\u5c06jsx\u4ee3\u7801\u8f6c\u6362\u4e3aroot.render()\u8c03\u7528,\u6b64\u65f6\u5f97\u5230\u8f6c\u5316\u540e\u7684Ast\u6811\u7ed3\u6784"),(0,a.kt)("li",{parentName:"ul"},"react17\u4e2d \u4f7f\u7528 babel\u5c06jsx\u4ee3\u7801\u8f6c\u6362\u4e3aReact.createElement()\u8c03\u7528,\u6b64\u65f6\u5f97\u5230\u8f6c\u5316\u540e\u7684Ast\u6811\u7ed3\u6784")),(0,a.kt)("h3",{id:"\u7b80\u5355\u5b9e\u4f8b1babel\u5c06jsx\u4ee3\u7801\u8f6c\u6362\u4e3areactcreateelement\u8c03\u7528"},"\u7b80\u5355\u5b9e\u4f8b1:babel\u5c06jsx\u4ee3\u7801\u8f6c\u6362\u4e3aReact.createElement()\u8c03\u7528"),(0,a.kt)("p",null,"\u6d4b\u8bd5\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://www.babeljs.cn/repl"},"https://www.babeljs.cn/repl")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'// jsx\nconst element = <h1 style = {{"color": "red"}}>123\n    <div>test</div>\n</h1>\n\n// babel \u7f16\u8bd1\u8fc7\u540e\u751f\u6210\u7684\u4ee3\u7801\nconst element = /*#__PURE__*/React.createElement("h1", {\n  style: {\n    "color": "red"\n  }\n}, "123", /*#__PURE__*/React.createElement("div", null, "test"));\n')),(0,a.kt)("h3",{id:"\u7b80\u5355\u5b9e\u4f8b2\u76f4\u63a5\u7528\u8f6c\u5316\u540e\u7684\u4ee3\u7801\u53bb\u8c03\u7528reactcreateelement"},"\u7b80\u5355\u5b9e\u4f8b2:\u76f4\u63a5\u7528\u8f6c\u5316\u540e\u7684\u4ee3\u7801\u53bb\u8c03\u7528React.createElement"),(0,a.kt)("p",null,"\u6e32\u67d3\u4ee3\u7801\uff1aexample-code\\\u4f8b-1-jsx-ast-r17.html"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<script>\nconst container = document.getElementById('root');\nconst element = React.createElement(\n    'div',\n    { className: 'red' },\n    'Click Me'\n)\nconsole.log('createElement \u8f6c\u5316\u540east\u6811\u7684\u7ed3\u6784:', element)\nReactDOM.render(element, container)\n/*\n{\n    $$typeof: Symbol(react.element)\n    key: null\n    props:\n    children: \"Click Me\"\n    className: \"red\"\n    [[Prototype]]: Object\n    ref: null\n    type: \"div\"\n    _owner: null\n    _store: {validated: false}\\\n}\n*/\n<\/script>\n")),(0,a.kt)("h3",{id:"\u7b80\u5355\u5b9e\u4f8b3\u4f7f\u7528babel"},"\u7b80\u5355\u5b9e\u4f8b3\uff1a\u4f7f\u7528babel"),(0,a.kt)("p",null,"\u6e32\u67d3\u4ee3\u7801\uff1aexample-code\\\u4f8b4-\u5728html-\u4f7f\u7528babel\u8f6c\u4e49jsx.html"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<script type="text/babel">\n  function Test() {\n    return (\n      <div className="red">Click Me</div>\n    )\n  }\n\n  ReactDOM.render(<Test />, document.getElementById(\'root\'))\n<\/script>\n')),(0,a.kt)("h2",{id:"\u5b8c\u6574\u6d4b\u8bd5\u4f8b\u5b50"},"\u5b8c\u6574\u6d4b\u8bd5\u4f8b\u5b50"),(0,a.kt)("p",null,"\u4f8b\u5b50\u57fa\u4e8ereact18,\u5148\u770bbabel \u7684\u6267\u884c\u51fd\u6570"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"function transform(code, options) {\n  console.log('=Babel-transform-\u53c2\u6570:', { code })\n  const babel_transform = Babel.transform(code, processOptions(options));\n  console.log('=Babel-\u8fd4\u56de:', babel_transform)\n  return babel_transform\n}\n")),(0,a.kt)("h3",{id:"\u6d4b\u8bd5\u4ee3\u7801"},"\u6d4b\u8bd5\u4ee3\u7801"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<script type=\"text/babel\">\n  console.log('=Babel:', Babel)\n  function Test() {\n    console.log('test-render')\n    const [data, setData] = React.useState('\u6539\u53d8\u6211')\n    const [showDiv, setShowDiv] = React.useState(false)\n\n    const onClickText = () => {\n      console.log('=useState=onClick');\n      setData('\u52aa\u529b\u54e6')\n      setShowDiv(!showDiv)\n    }\n\n    const onClickText2 = () => {\n      console.log('=useState=onClick:', data);\n    }\n\n    React.useEffect(() => {\n      console.log('=\u526f\u4f5c\u7528-useEffect--\x3e\u8fd0\u884c');\n    }, [])\n\n    React.useLayoutEffect(() => {\n      console.log('=\u526f\u4f5c\u7528-useLayoutEffect--\x3e\u8fd0\u884c');\n    }, [])\n\n    return (\n      <div id='div1' className='c1'>\n        <button onClick={onClickText} className=\"btn\">Hello world,Click me</button>\n        <span>{data}</span>\n        {showDiv && <div>\u88ab\u4f60\u53d1\u73b0\u4e86</div>}\n        <div id='div2' className='c2'>\n          <p>\u6d4b\u8bd5\u5b50\u8282\u70b9</p>\n        </div>\n      </div>\n    )\n  }\n\n  const root = ReactDOM.createRoot(document.getElementById('root'))\n  console.log(\"=app=root:\", root)\n  root.render(<Test />);\n<\/script>\n")),(0,a.kt)("h3",{id:"render\u9636\u6bb5-babel\u751f\u6210\u7684astjson"},"render\u9636\u6bb5-babel\u751f\u6210\u7684AST.json"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/huiruo/programming-tech-website/blob/main/programming-tech/Vue/02-mockData-compile%E8%B0%83%E7%94%A8baseParse%E8%BF%94%E5%9B%9East.json"},"\u7f16\u8bd1\u9636\u6bb5-babel\u751f\u6210\u7684code\u51fd\u6570")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n"metadata":"",\n"options":"",\n"ignored":"",\n"code":"",\n"ast":"",\n"map":""\n}\n')),(0,a.kt)("h3",{id:"code\u51fd\u6570"},"code\u51fd\u6570"),(0,a.kt)("p",null,"\u6bcf\u4e2a\u8282\u70b9\u90fd\u8c03\u7528createElement(),\u5e76\u4e14\u5d4c\u5957\u7ed3\u6784\u90fd\u662f\u548chtml\u8282\u70b9\u4e00\u6837"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nconsole.log('=Babel:', Babel);\nfunction Test() {\n  console.log('test-render');\n\n  var _React$useState = React.useState('\u6539\u53d8\u6211'),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    data = _React$useState2[0],\n    setData = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    showDiv = _React$useState4[0],\n    setShowDiv = _React$useState4[1];\n\n  var onClickText = function onClickText() {\n    console.log('=useState=onClick');\n    setData('\u52aa\u529b\u54e6');\n    setShowDiv(!showDiv);\n  };\n\n  var onClickText2 = function onClickText2() {\n    console.log('=useState=onClick:', data);\n  };\n\n  React.useEffect(function () {\n    console.log('=\u526f\u4f5c\u7528-useEffect--\x3e\u8fd0\u884c');\n  }, []);\n\n  React.useLayoutEffect(function () {\n    console.log('=\u526f\u4f5c\u7528-useLayoutEffect--\x3e\u8fd0\u884c');\n  }, []);\n\n  return React.createElement(\n    'div',\n    { id: 'div1', className: 'c1' },\n    React.createElement(\n      'button',\n      { onClick: onClickText, className: 'btn' },\n      'Hello world,Click me'\n    ),\n    React.createElement(\n      'span',\n      null,\n      data\n    ),\n    showDiv && React.createElement(\n      'div',\n      null,\n      '\\u88AB\\u4F60\\u53D1\\u73B0\\u4E86'\n    ),\n    React.createElement(\n      'div',\n      { id: 'div2', className: 'c2' },\n      React.createElement(\n        'p',\n        null,\n        '\\u6D4B\\u8BD5\\u5B50\\u8282\\u70B9'\n      )\n    )\n  );\n}\n\nvar root = ReactDOM.createRoot(document.getElementById('root'));\nconsole.log(\"=app=root:\", root);\nroot.render(React.createElement(Test, null));\n")),(0,a.kt)("h3",{id:"createelement"},"createElement()"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"function createElement(type, config, children) {\n  // console.log('=development\u8c03\u7528createElement\u6784\u5efaAst\u6811:', { type, config, children })\n  console.log('%c=development\u8c03\u7528createElement-1:type', 'color:blueviolet', type, { config, children })\n  var propName; // Reserved names are extracted\n\n  var props = {};\n  var key = null;\n  var ref = null;\n  var self = null;\n  var source = null;\n\n  if (config != null) {\n    if (hasValidRef(config)) {\n      ref = config.ref;\n\n      {\n        warnIfStringRefCannotBeAutoConverted(config);\n      }\n    }\n\n    if (hasValidKey(config)) {\n      {\n        checkKeyStringCoercion(config.key);\n      }\n\n      key = '' + config.key;\n    }\n\n    self = config.__self === undefined ? null : config.__self;\n    source = config.__source === undefined ? null : config.__source; // Remaining properties are added to a new props object\n\n    for (propName in config) {\n      if (hasOwnProperty.call(config, propName) && !RESERVED_PROPS.hasOwnProperty(propName)) {\n        props[propName] = config[propName];\n      }\n    }\n  } // Children can be more than one argument, and those are transferred onto\n  // the newly allocated props object.\n\n\n  var childrenLength = arguments.length - 2;\n\n  if (childrenLength === 1) {\n    props.children = children;\n  } else if (childrenLength > 1) {\n    var childArray = Array(childrenLength);\n\n    for (var i = 0; i < childrenLength; i++) {\n      childArray[i] = arguments[i + 2];\n    }\n\n    {\n      if (Object.freeze) {\n        Object.freeze(childArray);\n      }\n    }\n\n    props.children = childArray;\n  } // Resolve default props\n\n\n  if (type && type.defaultProps) {\n    var defaultProps = type.defaultProps;\n\n    for (propName in defaultProps) {\n      if (props[propName] === undefined) {\n        props[propName] = defaultProps[propName];\n      }\n    }\n  }\n\n  {\n    if (key || ref) {\n      var displayName = typeof type === 'function' ? type.displayName || type.name || 'Unknown' : type;\n\n      if (key) {\n        defineKeyPropWarningGetter(props, displayName);\n      }\n\n      if (ref) {\n        defineRefPropWarningGetter(props, displayName);\n      }\n    }\n  }\n  const reactElementRes = ReactElement(type, key, ref, self, source, ReactCurrentOwner.current, props);\n  console.log('=development\u8c03\u7528createElement-2:\u8fd4\u56de:', reactElementRes)\n  return reactElementRes\n}\n")))}d.isMDXComponent=!0}}]);